!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.simplifr=t.simplifr||{})}(this,function(t){"use strict";function e(){return{dilimiter:"."}}function i(t,i,r,n){function o(t,e){if(n[e]={type:"object",childs:[]},a(t)){n[e].type="array";for(var r=-1,c=t.length;++r<c;)n[e].childs.push(r),o(t[r],e+i+r)}else if(p(t))for(var u in t)t.hasOwnProperty(u)&&(n[e].childs.push(u),o(t[u],e+i+u));else n[e]=t;return n}return n=n||{},r=r||"root",i=i||e().dilimiter,o(t,r),n}function r(t,r,n,o){o=o||e().dilimiter;var c=t[r];if("array"===c.type){var u=Math.max.apply(null,c.childs);a(n)||(n=[n]),n.forEach(function(e){c.childs.push(++u),i(e,o,r+o+u,t)})}else if("object"===c.type){var l=Object.keys(n);l.forEach(function(e){c.childs.push(e),i(n[e],o,r+o+e,t)})}return t}function n(t,e,r,n){return c(t,e,n),i(r,n,e,t),t}function o(t,i,r){r=r||e().dilimiter;var n=i.split(r),o=n.pop(),c=n.length?t[n.join(r)]:t;"array"===c.type&&(o=+o);var l=c.childs.indexOf(o);return l>-1&&c.childs.splice(l,1),u(t,i,r),t}function c(t,i,r){return r=r||e().dilimiter,u(t,i,r),t[i]=null,t}function u(t,i,r){r=r||e().dilimiter;var n=t[i];return"array"!==n.type&&"object"!==n.type||n.childs.forEach(function(e){u(t,i+r+e)}),delete t[i],t}function l(t,i,r,n){n=n||e().dilimiter;var o=i.split(n).slice(1);return s(t,o,function(t,e){var i=t[e];if(a(i))a(r)||(r=[r]),i.push.apply(i,r);else if(p(r))for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n]);return i}),t}function f(t,i,r){r=r||e().dilimiter;var n=i.split(r).slice(1);return s(t,n,function(t,e){return t[e]=null}),t}function s(t,e,i){return e.length>1?s(t[e.shift()],e,i):i(t,e.shift())}function a(t){return"[object Array]"===Object.prototype.toString.call(t)}function p(t){return"[object Object]"===Object.prototype.toString.call(t)}t.simplify=i,t.add=r,t.update=n,t.remove=o,t.reset=c,t.addRaw=l,t.resetRaw=f});