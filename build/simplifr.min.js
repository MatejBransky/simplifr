!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i(t.simplifr=t.simplifr||{})}(this,function(t){"use strict";function i(){return{root:"root",dilimiter:"."}}function r(t,r,n){return r=r||i().dilimiter,n=n||i().root,e({},n,t,r)}function e(t,r,e,n){function o(i,r){if(t[r]={type:"object",childs:[]},y(i)){t[r].type="array";for(var e=-1,u=i.length;++e<u;)t[r].childs.push(e),o(i[e],r+n+e)}else if(m(i))for(var l in i)i.hasOwnProperty(l)&&(t[r].childs.push(l),o(i[l],r+n+l));else t[r]=i;return t}return n=n||i().dilimiter,o(e,r),t}function n(t,r,n,o){o=o||i().dilimiter;var u=t[r];if("array"===u.type){var l=Math.max.apply(null,u.childs);y(n)||(n=[n]),n.forEach(function(i){u.childs.push(++l),e(t,r+o+l,i,o)})}else if("object"===u.type){var c=Object.keys(n);c.forEach(function(i){u.childs.push(i),e(t,r+o+i,n[i],o)})}return t}function o(t,i,r,n){return l(t,i,n),e(t,i,r,n),t}function u(t,r,e){e=e||i().dilimiter;var n=r.split(e),o=n.pop(),u=n.length?t[n.join(e)]:t;"array"===u.type&&(o=+o);var l=u.childs.indexOf(o);return l>-1&&u.childs.splice(l,1),f(t,r,e),t}function l(t,r,e){return e=e||i().dilimiter,f(t,r,e),t[r]=null,t}function c(t,r,e){e=e||i().dilimiter;for(var n,o,u,l=r.split(e),c=l.shift(),f=[c];u=l.shift();)o=t[c],"array"===o.type?(n=o.childs.indexOf(+u),f.push(n)):f.push(u),c+=e+u;return f.join(e)}function f(t,r,e){e=e||i().dilimiter;var n=t[r];return"array"!==n.type&&"object"!==n.type||n.childs.forEach(function(i){f(t,r+e+i)}),delete t[r],t}function s(t,r,e,n){n=n||i().dilimiter;var o=r.split(n).slice(1);return h(t,o,function(t,i){var r=t[i];if(y(r))y(e)||(e=[e]),r.push.apply(r,e);else if(m(e))for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r}),t}function a(t,r,e){e=e||i().dilimiter;var n=r.split(e).slice(1);return h(t,n,function(t,i){return t[i]=null}),t}function p(t,r,e){e=e||i().dilimiter;var n=r.split(e).slice(1);return h(t,n,function(t,i){return y(t)?(t.splice(+i,1),t):delete t[i]}),t}function d(t,r,e,n){n=n||i().dilimiter;var o=r.split(n).slice(1);return h(t,o,function(t,i){return t[i]=e}),t}function h(t,i,r){return i.length>1?h(t[i.shift()],i,r):r(t,i.shift())}function y(t){return"[object Array]"===Object.prototype.toString.call(t)}function m(t){return"[object Object]"===Object.prototype.toString.call(t)}t.simplify=r,t.simplifyNode=e,t.add=n,t.update=o,t.remove=u,t.reset=l,t.truePath=c,t.addRaw=s,t.resetRaw=a,t.removeRaw=p,t.updateRaw=d});