!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i(t.simplifr=t.simplifr||{})}(this,function(t){"use strict";function i(){return{dilimiter:"."}}function e(t,e,r,n){function u(t,i){if(n[i]={type:"object",childs:[]},h(t)){n[i].type="array";for(var r=-1,o=t.length;++r<o;)n[i].childs.push(r),u(t[r],i+e+r)}else if(y(t))for(var c in t)t.hasOwnProperty(c)&&(n[i].childs.push(c),u(t[c],i+e+c));else n[i]=t;return n}return n=n||{},r=r||"root",e=e||i().dilimiter,u(t,r),n}function r(t,r,n,u){u=u||i().dilimiter;var o=t[r];if("array"===o.type){var c=Math.max.apply(null,o.childs);h(n)||(n=[n]),n.forEach(function(i){o.childs.push(++c),e(i,u,r+u+c,t)})}else if("object"===o.type){var l=Object.keys(n);l.forEach(function(i){o.childs.push(i),e(n[i],u,r+u+i,t)})}return t}function n(t,i,r,n){return o(t,i,n),e(r,n,i,t),t}function u(t,e,r){r=r||i().dilimiter;var n=e.split(r),u=n.pop(),o=n.length?t[n.join(r)]:t;"array"===o.type&&(u=+u);var c=o.childs.indexOf(u);return c>-1&&o.childs.splice(c,1),l(t,e,r),t}function o(t,e,r){return r=r||i().dilimiter,l(t,e,r),t[e]=null,t}function c(t,e,r){r=r||i().dilimiter;for(var n,u,o,c=e.split(r),l=c.shift(),f=[l];o=c.shift();)u=t[l],"array"===u.type?(n=u.childs.indexOf(+o),f.push(n)):f.push(o),l+=r+o;return f.join(r)}function l(t,e,r){r=r||i().dilimiter;var n=t[e];return"array"!==n.type&&"object"!==n.type||n.childs.forEach(function(i){l(t,e+r+i)}),delete t[e],t}function f(t,e,r,n){n=n||i().dilimiter;var u=e.split(n).slice(1);return d(t,u,function(t,i){var e=t[i];if(h(e))h(r)||(r=[r]),e.push.apply(e,r);else if(y(r))for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n]);return e}),t}function s(t,e,r){r=r||i().dilimiter;var n=e.split(r).slice(1);return d(t,n,function(t,i){return t[i]=null}),t}function a(t,e,r){r=r||i().dilimiter;var n=e.split(r).slice(1);return d(t,n,function(t,i){return h(t)?(t.splice(+i,1),t):delete t[i]}),t}function p(t,e,r,n){n=n||i().dilimiter;var u=e.split(n).slice(1);return d(t,u,function(t,i){return t[i]=r}),t}function d(t,i,e){return i.length>1?d(t[i.shift()],i,e):e(t,i.shift())}function h(t){return"[object Array]"===Object.prototype.toString.call(t)}function y(t){return"[object Object]"===Object.prototype.toString.call(t)}t.simplify=e,t.add=r,t.update=n,t.remove=u,t.reset=o,t.truePath=c,t.addRaw=f,t.resetRaw=s,t.removeRaw=a,t.updateRaw=p});