!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i(t.simplifr=t.simplifr||{})}(this,function(t){"use strict";function i(){return{root:"root",dilimiter:"."}}function e(t,e,r){return e=e||i().dilimiter,r=r||i().root,f({},r,t,e)}function r(t,e,r,n){n=n||i().dilimiter;var o=t[e];if("array"===o.type){var c=Math.max.apply(null,o.childs);p(r)||(r=[r]),r.forEach(function(i){o.childs.push(++c),f(t,e+n+c,i,n)})}else if("object"===o.type){var u=Object.keys(r);u.forEach(function(i){o.childs.push(i),f(t,e+n+i,r[i],n)})}return t}function n(t,i,e,r){return c(t,i,r),f(t,i,e,r),t}function o(t,e,r){r=r||i().dilimiter;var n=e.split(r),o=n.pop(),c=n.length?t[n.join(r)]:t;"array"===c.type&&(o=+o);var u=c.childs.indexOf(o);return u>-1&&c.childs.splice(u,1),l(t,e,r),t}function c(t,e,r){return r=r||i().dilimiter,l(t,e,r),t[e]=null,t}function u(t,e,r){function n(i){var e,o=t[i];return"array"===o.type?(e=[],o.childs.forEach(function(t){e.push(n(i+r+t))})):"object"===o.type?(e={},o.childs.forEach(function(t){e[t]=n(i+r+t)})):e=o,e}return r=r||i().dilimiter,e=e||i().root,n(e)}function f(t,e,r,n){function o(i,e){if(t[e]={type:"object",childs:[]},p(i)){t[e].type="array";for(var r=-1,c=i.length;++r<c;)t[e].childs.push(r),o(i[r],e+n+r)}else if(a(i))for(var u in i)i.hasOwnProperty(u)&&(t[e].childs.push(u),o(i[u],e+n+u));else t[e]=i;return t}return n=n||i().dilimiter,o(r,e),t}function l(t,e,r){r=r||i().dilimiter;var n=t[e];return"array"!==n.type&&"object"!==n.type||n.childs.forEach(function(i){l(t,e+r+i)}),delete t[e],t}function p(t){return"[object Array]"===Object.prototype.toString.call(t)}function a(t){return"[object Object]"===Object.prototype.toString.call(t)}t.simplify=e,t.add=r,t.update=n,t.remove=o,t.reset=c,t.desimplify=u});